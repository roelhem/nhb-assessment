#!/usr/bin/env sh

: "${NHBCMD:="$(dirname "$0")/../nhb-assessment"}"
TMPFILE="$(mktemp -t XXXXX_maximum_by_income.ini)"

"$NHBCMD" init "$TMPFILE" || exit 1
watchexec --watch "$TMPFILE" --quiet --clear --postpone -- "\"$NHBCMD\" run \"$TMPFILE\" > /dev/null" &
WATCHPID="$!"

cleanup() {
    rm "$TMPFILE"
    kill "$WATCHPID"
}
trap cleanup EXIT


code --wait "$TMPFILE"
